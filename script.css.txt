const API_URL = 'https://crudcrud.com/api/e5baa7edff4d4c95a6eabaa12aee488f/products';

const form = document.getElementById('productForm');
const productList = document.getElementById('productList');

// Function to fetch products from the API
function fetchProducts() {
  fetch(API_URL)
    .then(response => response.json())
    .then(data => {
      productList.innerHTML = '';

      data.forEach(product => {
        const listItem = createProductListItem(product);
        productList.appendChild(listItem);
      });
    })
    .catch(error => console.error('Error fetching products:', error));
}

// Function to create a new product list item
function createProductListItem(product) {
  const listItem = document.createElement('li');
  listItem.textContent = `${product.sellingPrice} - ${product.category} - ${product.productName}`;

  const deleteButton = document.createElement('button');
  deleteButton.textContent = 'Delete';
  deleteButton.addEventListener('click', () => {
    deleteProduct(product._id);
  });

  listItem.appendChild(deleteButton);

  return listItem;
}

// Function to add a new product
function addProduct(sellingPrice, productName, category) {
  fetch(API_URL, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      sellingPrice,
      productName,
      category
    })
  })
    .then(response => response.json())
    .then(product => {
      const listItem = createProductListItem(product);
      productList.appendChild(listItem);
    })
    .catch(error => console.error('Error adding product:', error));
}

// Function to delete a product
function deleteProduct(productId) {
  fetch(`${API_URL}/${productId}`, {
    method: 'DELETE'
  })
    .then(() => {
      fetchProducts();
    })
    .catch(error => console.error('Error deleting product:', error));
}

// Event listener for form submission
form.addEventListener('submit', (event) => {
  event.preventDefault();

  const sellingPrice = document.getElementById('sellingPrice').value;
  const productName = document.getElementById('productName').value;
  const category = document.getElementById('category').value;

  addProduct(sellingPrice, productName, category);
  form.reset();
});

// Fetch products on page load
fetchProducts();
